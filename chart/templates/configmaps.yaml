kind: ConfigMap
apiVersion: v1
metadata:
  name: 98-var-partition
  namespace: {{ .Values.cluster.namespace }}
data:
  98-var-partition.yaml : |
    # Generated by Butane; do not edit
    apiVersion: machineconfiguration.openshift.io/v1
    kind: MachineConfig
    metadata:
      labels:
        machineconfiguration.openshift.io/role: master
      name: 98-var-partition
    spec:
      config:
        ignition:
          version: 3.4.0
        storage:
          disks:
            - device: /dev/sda
              partitions:
                - label: var
                  number: 5
                  sizeMiB: 25217
                  startMiB: 25217
                - label: lvmstorage
                  number: 6
                  sizeMiB: 0
          filesystems:
            - device: /dev/disk/by-partlabel/var
              format: xfs
              label: var
              mountOptions:
                - defaults
                - prjquota
              path: /var
              wipeFilesystem: true
        systemd:
          units:
            - contents: |-
                # Generated by Butane
                [Unit]
                Requires=systemd-fsck@dev-disk-by\x2dpartlabel-var.service
                After=systemd-fsck@dev-disk-by\x2dpartlabel-var.service

                [Mount]
                Where=/var
                What=/dev/disk/by-partlabel/var
                Type=xfs
                Options=defaults,prjquota

                [Install]
                RequiredBy=local-fs.target
              enabled: true
              name: var.mount
